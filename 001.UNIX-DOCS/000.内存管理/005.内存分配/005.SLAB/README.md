# SLAB(SLUB/SLOB) <sup>一种资源池: 固定分配大小一致的内存块，因此，SLAB在使用前都要先使用kmem_cache_create创建，其中参数就能提现这一点, 可以认为是为每个特殊的结构创建SLAB资源池，这个资源池是为了某一类的数据结构而服务的</sup>
> 建立在伙伴系统之上的分配器<sup>伙伴系统分配的最小单位是一个物理页(4K),操作系统中的结构体大小通常是几十、几百字节</sup>

slab分配器最终还使用伙伴系统来分配实际的物理页面，只不过slab分配器在这些连续的物理页面上实现了自己的机制，以此来对小内存块进行管理

尽管slab分配器在很多工作负荷下都工作良好，但在一些情况下无法提供最优的性能，如微小嵌入式系统或者有大量物理内存的超级计算机。在大内存的超级计算机中，slab机制所需要的元数据占用好几千兆字节的内存；对于微小嵌入式系统，slab机制的代码量和复杂度也很大。因此linux内核中提供了另外两种替代机制——slob机制和slub机制。slob机制适合微小嵌入式系统，slub机制在大型系统中能提供比slab机制更好的性能。


## 基本思想 <sup>操作系统频繁分配的对象大小相对比较固定： 若一个变量大小是8字节，那么不论分配1个还是100个，都是以8字节为单位进行分配。结构体也是如此，因此得出该基本思想</sup>
- 从伙伴系统中获得大块内存 
- 进一步细分为固定大小的小块内存进行管理
  + 块大小一般是2^n个字节
  + 可以额外增加特殊大小，如198字节从而减小内部碎片
  + 结构体进行内存分配总是按照一定字节进行分配的——字节对齐
    - 如，按8字节对齐，那么进行内存分配时，按照8字节为单位进行分配



## 参考资料
- [07-物理内存管理I：伙伴系统 [中山大学 操作系统原理]](https://www.bilibili.com/video/BV1jq421P7f7/?spm_id_from=333.1007.top_right_bar_window_history.content.click&vd_source=9eef164b234175c1ae3ca71733d5a727)
   - [000.中山大学-操作系统/4-0317-physical-mem-1.pdf](../../998.REFS/000.中山大学-操作系统/4-0317-physical-mem-1.pdf)
   - [000.中山大学-操作系统/4-0320-physical-mem-2.pdf](../../998.REFS/000.中山大学-操作系统/4-0320-physical-mem-2.pdf)
- [4.2　slab分配器](../../../../007.BOOKs/Run%20Linux%20Kernel%20(2nd%20Edition)%20Volume%201:%20Infrastructure.epub)