# GCC内联汇编 <sup>理解内联汇编</sup>
```c
__asm__ __volatile__(指令部: 输出部: 输入部: 损坏部)


<arch/arm64/include/asm/irqflags.h>

// 该函数主要用于把PSTATE寄存器中的DAIF域保存到临时变量flags中，然后关闭IRQ
static inline unsigned long arch_local_irq_save(void)
{
    unsigned long flags;
    asm volatile(
        "mrs    %0, daif         //读取PSTAT寄存器中的DAIF域到flags变量
        "msr    daifset, #2"     //关闭IRQ
        : "=r" (flags)
        :
        : "memory");
    return flags;
}

/**
 * #2 是立即数，拆为二进制理解: 
*/


```

## 参考
- [Run Linux Kernel (2nd Edition) Volume 1: Infrastructure.epub]#1.5　GCC内联汇编