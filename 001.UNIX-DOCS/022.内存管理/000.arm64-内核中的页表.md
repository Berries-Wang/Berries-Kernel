# arm64-内核中的页表
## arm64的Linux内核的4级分页模型<sup>[Run Linux Kernel (2nd Edition) Volume 1: Infrastructure.epub]#2.1.4　Linux内核中的页表</sup>
PGD(Page Global Directory) -> PUD(Page Upper Directory) -> PMD(Page Middle Directory) -> PT(Page Table)

## 查找下一个页表基地址的虚拟地址
- [Run Linux Kernel (2nd Edition) Volume 1: Infrastructure.epub]#‘图2.20　查找下一个页表基地址的虚拟地址’

### Q&A
##### 1. 如何理解 ‘在Linux内核里，物理内存会线性映射到内核空间里，偏移量为PAGE_OFFSET’


##### 2. 如何理解 ‘无论是内核空间还是用户空间都可以通过处理器提供的页表机制映射到实际的物理地址’
---

## L0～L2页表项包含了指向下一级页表的基地址，那么这个下一级页表基地址采用的是物理地址还是虚拟地址？
> 物理地址，详见:[Run Linux Kernel (2nd Edition) Volume 1: Infrastructure.epub]#2.7.1　关于下一级页表基地址


---

## arm64页表映射过程 <sup>[Run Linux Kernel (2nd Edition) Volume 1: Infrastructure.epub]#2.1.6　案例分析：ARM64的页表映射过程</sup>
> 代码分析流程： start_kenrel()-> setup_arch()->paging_init()

### 什么是 KIMAGE_VOFFSET
kimage_voffset表示内核映像虚拟地址和物理地址之间的偏移量 - 当系统刚初始化时，内核映像通过块映射的方式映射到KIMAGE_VADDR + TEXT_OFFSET的虚拟地址上
- ![wechat_2025-07-27_152032_844.png](./999.IMGS/wechat_2025-07-27_152032_844.png)


---

## 参考资料
- [Run Linux Kernel (2nd Edition) Volume 1: Infrastructure.epub]#2.1.2　页表映射
- pte表示页表项