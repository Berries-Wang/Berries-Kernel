# pgd_set_fixmap　做了什么
- 000.SOURCE_CODE/000.LINUX-5.9/000.LINUX-5.9/arch/arm64/mm/mmu.c:'void __init paging_init(void)'

```c
      /**
       *  swapper_pg_dir 内核页表的基地址(虚拟地址)
       */
      pgd_t *pgdp = pgd_set_fixmap(__pa_symbol(swapper_pg_dir));
       
       // 宏展开后
      pgd_t *pgdp = ((pgd_t *)({
		unsigned long ________addr;
		__set_fixmap( //mmu.c: "void __set_fixmap(enum fixed_addresses idx, phys_addr_t phys, pgprot_t prot)"?
			FIX_PGD, // ?arch/arm64/include/asm/fixmap.h
			(((phys_addr_t)(({
				 unsigned long __ptr;
				 __asm__(""
					 : "=r"(__ptr)
					 : "0"((unsigned long)(swapper_pg_dir)));
				 (typeof((unsigned long)(swapper_pg_dir)))(__ptr + (0));
			 }))) -
			 kimage_voffset),
			((pgprot_t){ (((((((pteval_t)(3)) << 0) |
					 (((pteval_t)(1)) << 10) |
					 (((pteval_t)(3)) << 8)) |
					(arm64_use_ng_mappings ?
						 (((pteval_t)(1)) << 11) : 0)) |
				       (((pteval_t)(1)) << 53) |
				       (((pteval_t)(1)) << 54) |
				       ((((pteval_t)(1)) << 51)) |
				       (((pteval_t)((4))) << 2))) }));
		________addr =
			fix_to_virt(FIX_PGD) +     // include/asm-generic/fixmap.h 'static __always_inline unsigned long fix_to_virt(const unsigned int idx)'?
			(((((phys_addr_t)(({
				   unsigned long __ptr;
				   __asm__(""
					   : "=r"(__ptr)
					   : "0"((unsigned long)(swapper_pg_dir)));
				   (typeof((
					   unsigned long)(swapper_pg_dir)))(__ptr +
									    (0));
			   }))) -
			   kimage_voffset)) &
			 (((1UL) << 12) - 1));
		________addr;
	}));


```